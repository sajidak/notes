# NuGet Packages for MVC 5 App
**Download URL base:** `http://packages.nuget.org/api/v2/package/{package-name}[/{version}]`

[TOC]

## Packages by default in MVC
|                           Package                            |  Version   |    Nuget Ver    |                                                 Download URL                                                 |
| ------------------------------------------------------------ | ---------- | --------------- | ------------------------------------------------------------------------------------------------------------ |
| Antlr                                                        | 3.4.1.9004 | 3.5.0.2         | [get](http://packages.nuget.org/api/v2/package/Antlr)                                                        |
| bootstrap                                                    | 3.0.0      | -NA-            | [get](http://packages.nuget.org/api/v2/package/bootstrap/4.0.0-alpha6)                                       |
| EntityFramework                                              | 6.1.3      | 6.1.3           | [get](http://packages.nuget.org/api/v2/package/EntityFramework)                                              |
| jQuery                                                       | 1.10.2     | 3.2.1           | [get](http://packages.nuget.org/api/v2/package/jQuery)                                                       |
| jQuery.Validation                                            | 1.11.1     | 1.16.0          | [get](http://packages.nuget.org/api/v2/package/jQuery.Validation)                                            |
| Microsoft.ApplicationInsights                                | 2.2.0      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights)                                |
| Microsoft.ApplicationInsights.Agent.Intercept                | 2.0.6      | 2.0.7           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights.Agent.Intercept)                |
| Microsoft.ApplicationInsights.DependencyCollector            | 2.2.0      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights.DependencyCollector)            |
| Microsoft.ApplicationInsights.PerfCounterCollector           | 2.2.0      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights.PerfCounterCollector)           |
| Microsoft.ApplicationInsights.Web                            | 2.2.0      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights.Web)                            |
| Microsoft.ApplicationInsights.WindowsServer                  | 2.2.0      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights.WindowsServer)                  |
| Microsoft.ApplicationInsights.WindowsServer.TelemetryChannel | 2.2.0      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.ApplicationInsights.WindowsServer.TelemetryChannel) |
| Microsoft.AspNet.Identity.Core                               | 2.2.1      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.Identity.Core)                               |
| Microsoft.AspNet.Identity.EntityFramework                    | 2.2.1      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.Identity.EntityFramework)                    |
| Microsoft.AspNet.Identity.Owin                               | 2.2.1      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.Identity.Owin)                               |
| Microsoft.AspNet.Mvc                                         | 5.2.3      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.Mvc)                                         |
| Microsoft.AspNet.Razor                                       | 3.2.3      | 2.3.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.Razor)                                       |
| Microsoft.AspNet.Web.Optimization                            | 1.1.3      | 1.1.4           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.Web.Optimization)                            |
| Microsoft.AspNet.WebPages                                    | 3.2.3      | 3.2.3           | [get](http://packages.nuget.org/api/v2/package/Microsoft.AspNet.WebPages)                                    |
| Microsoft.CodeDom.Providers.DotNetCompilerPlatform           | 1.0.3      | 1.0.4           | [get](http://packages.nuget.org/api/v2/package/Microsoft.CodeDom.Providers.DotNetCompilerPlatform)           |
| Microsoft.jQuery.Unobtrusive.Ajax                            | -NA-       | 3.2.3           | [get](http://packages.nuget.org/api/v2/package/Microsoft.jQuery.Unobtrusive.Ajax)                            |
| Microsoft.jQuery.Unobtrusive.Validation                      | 3.2.3      | 3.2.3           | [get](http://packages.nuget.org/api/v2/package/Microsoft.jQuery.Unobtrusive.Validation)                      |
| Microsoft.Net.Compilers                                      | 1.3.2      | 2.2.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Net.Compilers)                                      |
| Microsoft.Owin                                               | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin)                                               |
| Microsoft.Owin.Host.SystemWeb                                | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Host.SystemWeb)                                |
| Microsoft.Owin.Security                                      | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security)                                      |
| Microsoft.Owin.Security.Cookies                              | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security.Cookies)                              |
| Microsoft.Owin.Security.Facebook                             | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security.Facebook)                             |
| Microsoft.Owin.Security.Google                               | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security.Google)                               |
| Microsoft.Owin.Security.MicrosoftAccount                     | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security.MicrosoftAccount)                     |
| Microsoft.Owin.Security.OAuth                                | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security.OAuth)                                |
| Microsoft.Owin.Security.Twitter                              | 3.0.1      | 3.1.0           | [get](http://packages.nuget.org/api/v2/package/Microsoft.Owin.Security.Twitter)                              |
| Microsoft.Web.Infrastructure                                 | 1.0.0.0    | 1.0.0.0         | [get](http://packages.nuget.org/api/v2/package/Microsoft.Web.Infrastructure)                                 |
| Modernizr                                                    | 2.6.2      | 2.8.3           | [get](http://packages.nuget.org/api/v2/package/Modernizr)                                                    |
| Newtonsoft.Json                                              | 6.0.4      | 10.0.2          | [get](http://packages.nuget.org/api/v2/package/Newtonsoft.Json)                                              |
| NLog                                                         | -NA-       | 4.4.10          | [get](http://packages.nuget.org/api/v2/package/NLog)                                                         |
| NLog.Config                                                  | -NA-       | 4.4.10          | [get](http://packages.nuget.org/api/v2/package/NLog.Config)                                                  |
| NLog.Extensions.Logging                                      | -NA-       | 1.0.0-rtm-beta5 | [get](http://packages.nuget.org/api/v2/package/NLog.Extensions.Logging/1.0.0-rtm-beta5)                      |
| NLog.Mvc                                                     | -NA-       | 1.0.8           | [get](http://packages.nuget.org/api/v2/package/NLog.Mvc)                                                     |
| NLog.Owin.Logging                                            | -NA-       | 1.1.0           | [get](http://packages.nuget.org/api/v2/package/NLog.Owin.Logging)                                            |
| NLog.Rest                                                    | -NA-       | 1.1.1           | [get](http://packages.nuget.org/api/v2/package/NLog.Rest)                                                    |
| NLog.Schema                                                  | -NA-       | 4.4.10          | [get](http://packages.nuget.org/api/v2/package/NLog.Schema)                                                  |
| NLog.Web                                                     | -NA-       | 4.5.0           | [get](http://packages.nuget.org/api/v2/package/NLog.Web)                                                     |
| NLog.WebViewer                                               | -NA-       | 0.1.0           | [get](http://packages.nuget.org/api/v2/package/NLog.WebViewer)                                               |
| Owin                                                         | 1.0        | 1.0.0           | [get](http://packages.nuget.org/api/v2/package/Owin)                                                         |
| PagedList                                                    | -NA-       | 1.17.0          | [get](http://packages.nuget.org/api/v2/package/PagedList)                                                    |
| PagedList.Mvc                                                | -NA-       | 4.5.0           | [get](http://packages.nuget.org/api/v2/package/PagedList.Mvc)                                                |
| Respond                                                      | 1.2.0      | 1.4.2           | [get](http://packages.nuget.org/api/v2/package/Respond)                                                      |
| WebGrease                                                    | 1.5.2      | -NA-            | [get](http://packages.nuget.org/api/v2/package/WebGrease)                                                    |


## Additional Packages:
- Microsoft.jQuery.Unobtrusive.Ajax
- PagedList
- PagedList.Mvc
- NLog
- NLog.Config
- NLog.Extensions.Logging
- NLog.Mvc
- NLog.Owin.Logging
- NLog.Rest
- NLog.Schema
- NLog.Web
- NLog.WebViewer


## NLog
https://github.com/NLog/NLog/wiki/Layout-Renderers

## NLog WebViewer
- In web.config `configSections` add `<section name="nlog.webviewer" type="NLog.WebViewer.Config, NLog.WebViewer" />`

- Sample configuration section:
```xml
<nlog.webviewer
    Fields="Date|Level|Logger|IpAddress|Message"
    Separator="|"
    FileFormat="{0:yyyy-MM-dd}.txt"
    Path="~/App_Data/Logs" />
```
- is valid for following NLog target:
```xml
<target name="logfile" type="File" encoding="utf-8"
    fileName="${basedir}/App_Data/Logs/${shortdate}.txt"
    layout="${longdate}|${uppercase:${level}}|${logger}|${aspnet-request:serverVariable=remote_addr}|${message}${onexception:${newline}${exception:format=tostring}}" />
```

- Following handler in `system.webServer\handlers` could be used to access logs page:
``` xml
<add name="LogsViewHandler" verb="*" path="Logs.axd"
     type="NLog.WebViewer.LogViewerHandler, NLog.WebViewer"
     resourceType="Unspecified" requireAccess="Read" />
```
Then log page will be available via link: `your_site_name/Logs.axd`


## NLog Mvc
- Designed to be used with ASP.NET MVC 3 or greater and Entity Framework 4.* NLog.Mvc provides a Target for NLog that uses a `DbContext` to write and access log entries. It also includes a `NLogHandleError` attribute that can be applied to log exceptions.
- It provides an NLog target that uses an Entity Framework DbContext to access log entries in a database.  This means you can enable/disable and configure the usage of NLog.Mvc via Web.Config just like any other NLog target
- see _Getting Started_ page of the Wiki
	- Add a connection string to your web.config
	- `<add name="LoggingContext" connectionString="Data Source=.\SQLEXPRESS; Initial Catalog=NLog.Mvc; Integrated Security=True; MultipleActiveResultSets=True; providerName="System.Data.SqlClient" />`
	- `MultipleActiveResultSets=True` is mandatory
	- **NB:** If you are trying to add `NLog.Mvc` to a project that has an existing `DbContext` instance
		- you will need to add the `LogEntryConfiguration` to the `DbModelBuilder.Configurations` collection in some way.
		- The simplest way to do this is to override `OnModelBuilding` in your existing `DbContext` and add the configuration something like this:
		```cs
		protected override void OnModelCreating(DbModelBuilder modelBuilder)
		{
		    modelBuilder.Configurations.Add(new LogEntryConfiguration());
		}
		```
- Manual db setup
```sql
CREATE TABLE [dbo].[Log]
(
    [Id]                 [INT]             NOT NULL	 IDENTITY(1,1)
        CONSTRAINT PK_Log PRIMARY KEY CLUSTERED,
    [TimeStamp]          [DATETIME]	       NOT NULL,
    [Level]              [NVARCHAR](5)     NOT NULL,
    [Logger]             [NVARCHAR](200)   NOT NULL,
    [Message]            [NVARCHAR](MAX)   NOT NULL,
    [ExceptionType]      [NVARCHAR](MAX)   NULL,
    [Operation]          [NVARCHAR](MAX)   NULL,
    [ExceptionMessage]   [NVARCHAR](MAX)   NULL,
    [StackTrace]         [NVARCHAR](MAX)   NULL
)
```

### nlog target, in web.config
- in `<configSections>` of web.config
	- add `<section name="nlog" type="NLog.Config.ConfigSectionHandler, NLog"/>`
- in web.config, add
```xml
<nlog>
    <extensions>
        <add assembly="NLog.Mvc"/>
    </extensions>
    <targets>
        <target name="NLogMvcLogger"
             type="DbContextTarget"
             ConnectionStringName="LoggingContext"
             layout="${longdate}|${level}|${logger}|${message}${onexception:|${exception:format=type}${exception:format=method}exception:format=message}|${exception:format=stacktrace}}" />
    </targets>
    <rules>
        <logger name="*" minLevel="Trace" appendTo="NLogMvcLogger"/>
    </rules>
</nlog>
```
- you can also inject the logger as a dependency of any component using an IoC container


### Using the NLogMvcHandlEerrorAttribute
in `Global.asax.cs`
```cs
private static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorAttribute());
}

private static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    var logger = DependencyResolver.Current.GetService<ILogger>();
    filters.Add(new NLogMvcHandleErrorAttribute(logger));
}
```

## NLog.Web (ASP.NET & ASP.NET Core)


### Known issues
- Installing the NuGet packages `NLog.config` / `NLog.schema` won't add to your project.
	- It's recommend to extract (unzip) the NLog.Schema package
	- and place the NLog.XSD in the same folder as NLog.config.
- auto load of NLog extensions won't work yet. Use `<extensions>`
